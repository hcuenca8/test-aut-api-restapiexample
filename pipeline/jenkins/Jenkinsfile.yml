pipeline {

  agent any

    stages {

      stage ('test') {
        steps {
          sh './gradlew clean test -Denvironment=pipeline'
        }

        post {
          always {
            publishHTML([
              allowMissing: false,
              alwaysLinkToLastBuild: false,
              keepAll: false,
              reportDir: 'target/site/serenity/',
              reportFiles: 'index.html',
              reportName: 'Serenity Report',
              reportTitles: '',
              useWrapperFileDirectly: true
            ])
          }
        }
      }
    }
}
